{% extends 'base.html.twig' %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('/css/productCards.css') }}">
    <link rel="stylesheet" href="{{ asset('/css/drive.css') }}">
{% endblock %}

{% block title %}Drive {% endblock %}

{% block body %}
    <div class="headDrive mb-5 d-flex flex-column justify-content-center align-items-center">
        <h2 class="styleBold mt-5 mb-4">Drive</h2>
        <p>Filtrez votre sélection de produits ou recherchez le directement</p>
        <div class="col-11">
            <fieldset>
                {{ form_start(formFilter) }}
                    {% set buttonChangeFilter = (form_widget(formFilter.changeFilter, { 'label': 'Changer les Filtres' })) %}
                    <div class="card bg-light mb-3">
                        <div class="card-header">Categories</div>
                        <div class="card-body">
                            <p class="card-text">Vous pouvez selectionner plusieurs catégories.</p>
                            <div class="filterDrive mb-5 row col-12 d-flex justify-content-center">
                                {% set choix = formFilter.categories.vars.choices  %}
                                {% for check in formFilter.categories %}
                                {% set i = loop.index %}
                                    <div class="form-check my-2 filterCard col-3 col-md-2 d-flex justify-content-center align-items-center">
                                        <label class="form-check-label mt-1">
                                            {{form_widget(check)}}
                                            <img src="{{ asset('/img/category/'~choix[i].data.urlIcon|e) }}" alt="Photo {{ check.vars.label }}" />
                                            <p>{{check.vars.label}}</p>
                                        </label>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                        <div class="card-footer text-muted d-flex justify-content-end">
                            {{ buttonChangeFilter|raw }}
                            <a href="{{ path('drive_clearFilter') }}#store" class="btn btn-danger mx-1" data-dismiss="modal">Supprimer les filtres</a>
                        </div>
                    </div>
                    <div class="card bg-light mb-3">
                        <div class="card-header">Saisons</div>
                        <div class="card-body">
                            <p class="card-text">Vous pouvez selectionner plusieurs saisons.</p>
                            <div class="filterDrive mb-5 row col-12 d-flex justify-content-center">
                                {% set choix = formFilter.seasons.vars.choices  %}
                                {% for check in formFilter.seasons %}
                                {% set i = loop.index %}
                                    <div class="form-check my-2 filterCard col-3 col-md-2 d-flex justify-content-center align-items-center">
                                        <label class="form-check-label mt-1">
                                            {{form_widget(check)}}
                                            <img src="{{ asset('/img/seasons/'~choix[i].data.urlIcon|e) }}" alt="Photo {{ check.vars.label }}" />
                                            <p>{{check.vars.label}}</p>
                                        </label>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                        <div class="card-footer text-muted d-flex justify-content-end">
                            {{ buttonChangeFilter|raw }}
                            <a href="{{ path('drive_clearFilter') }}#store" class="btn btn-danger mx-1" data-dismiss="modal">Supprimer les filtres</a>
                        </div>
                    </div>
                    <div class="card bg-light mb-3">
                        <div class="card-header">Prix</div>
                        <div class="card-body">
                            <p class="card-text">Choisissez votre tranche de prix.</p>
                            <div class="filterDrive my-4 row col-12 d-flex justify-content-center">
                                <fieldset class="col-12">
                                    <div class="row d-flex justify-content-center">
                                        <fieldset class="form-group col-4">
                                            <label for="customRange1">Tranche haute</label>
                                            <input type="range" class="custom-range" id="customRange1">
                                            <div class="form-group">
                                                <div class="input-group mb-3">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text">€</span>
                                                    </div>
                                                    {{ form_widget(formFilter.maxPrice)}}
                                                    <div class="input-group-append">
                                                        <span class="input-group-text">.00</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </fieldset>
                                        <fieldset class="form-group col-4">
                                            <label for="customRange1">Tranche basse</label>
                                            <input type="range" class="custom-range" id="customRange1">
                                            <div class="form-group">
                                                <div class="input-group mb-3">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text">€</span>
                                                    </div>
                                                    {{ form_widget(formFilter.minPrice)}}
                                                    <div class="input-group-append">
                                                        <span class="input-group-text">.00</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </fieldset>
                                    </div>
                                </fieldset>
                            </div>
                        </div>
                        <div class="card-footer text-muted d-flex justify-content-end">
                            {{ buttonChangeFilter|raw }}
                            <a href="{{ path('drive_clearFilter') }}#store" class="btn btn-danger mx-1" data-dismiss="modal">Supprimer les filtres</a>
                        </div>
                    </div>
                {{ form_end(formFilter) }}
            </fieldset>
        </div>
        <div class="searchDrive mb-5">
            <form class="form-inline my-2 my-lg-0">
                <input class="form-control mr-sm-2" type="text" placeholder="Rechercher un produit">
                <button class="btn btn-secondary my-2 my-sm-0" type="submit">Rechercher</button>
            </form>
        </div>
    </div>
    <div id="store" class="headStore col-12 d-flex flex-column flex-md-row p-5">
        <h3 class="styleBold mr-md-2 mr-lg-5 col-sm-12 col-md-6">Votre sélection :</h3>
        <p class="col-sm-12 col-md-6">Tous les Articles <span class="numberProductSelect">({{ products|length }} produits)</span></p>
    </div>
    <div class="store col-12 d-flex flex-column justify-content-center align-items-center">
        <div class="productsStore row col-12 justify-content-center">
            <div class="row flagshipProduct col-12 d-flex justify-content-center align-items-center">
                {% for product in products %}
                    <div class="productCard d-flex flex-column col-sm-10 col-md-5 col-lg-5 col-xl-3 mx-4 mb-5 justify-content-space-between">
                        <div class="">
                            <div class="col-12 d-flex flex-column align-items-center justify-content-between headProduct">
                                <h4 class="text-center">{{ product.name|capitalize }}</h4>
                                <div class="productPrice d-flex">
                                    <p>1.20€</p>
                                    <p class="productUnit ml-2">pièce</p>
                                </div>
                            </div>
                        </div>
                        <div class="">
                            <div class="col-12 d-flex justify-content-center my-3">
                                <img class="productImg" src="{{ asset('/img/products/'~product.picture.name|e) }}" alt="Photo de laitue" />
                            </div>
                        </div>
                        <div class="mb-2">
                            <div class="col-12 layoutInfoProduct d-flex justify-content-between align-items-center">
                                <div class="category d-flex align-items-center">
                                    <img src="{{ asset('/img/category/'~product.category.urlIcon|e) }}" alt="Icone {{product.category.title}}" />
                                    <p class="mx-2 my-0">{{ product.category.title|capitalize }}</p>
                                </div>
                                {% if product.season == true %}
                                    <div class="season d-flex align-items-center">
                                        <img src="{{ asset('/img/seasons/'~product.season.urlIcon|e) }}" alt="Icone {{product.season.name}}" />
                                        <p class="mx-2 my-0">{{ product.season.name|capitalize }}</p>
                                    </div>
                                {% endif %}
                            </div>
                            <!--<div class="col-12 describe">
                                <p>{{ product.description|capitalize }}</p>
                            </div>-->
                        </div>
                        <div class="row flex">
                            <div class="col-8 d-flex align-items-center justify-content-center layoutQuantity">
                                <ul class="productNumber d-flex m-0 p-0">
                                    <li class="productNumber-item mx-2">
                                    <a class="productNumber-link" href="#" aria-label="less">
                                        <span aria-hidden="true">&#45;</span>
                                    </a>
                                    </li>
                                    <li class="productNumber-item mx-2"><a class="productNumber-link" href="#">1</a></li>
                                    <li class="productNumber-item mx-2">
                                    <a class="productNumber-link" href="#" aria-label="more">
                                        <span aria-hidden="true">&#43;</span>
                                    </a>
                                    </li>
                                </ul>
                            </div>
                            <div class="col-4 d-flex align-items-center justify-content-center layoutCart">
                                <form method="POST" class="align-middle">
                                    <button title="Ajouter au panier" type="submit" formaction="/addCart" name="product" value="" class="btn text-muted"><i class="fas fa-shopping-cart mx-2"></i></button>
                                </form>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
            {% if paginate.nbPages > 0 %}
                <div class="col-12 d-flex justify-content-center align-items-center">
                    <ul class="pagination pagination-md">
                    {% if paginate.page > 1 %}
                        <li class="page-item">
                            <a  
                                class="page-link" 
                                href="{{ path(paginate.nameRoute,paginate.paramsRoute|merge({'page': 1})) }}#store"
                            >&laquo;</a>
                        </li>
                        <li class="page-item">
                            <a  
                                class="page-link" 
                                href="{{ path(paginate.nameRoute,paginate.paramsRoute|merge({'page': paginate.page-1})) }}#store"
                            >&#60;</a>
                        </li>
                    {% endif %}
                    {# Displays all pages between p-4 and p+4 unless < 1 or > nbPages #}
                    {% for p in range(max(paginate.page-4, 1), min(paginate.page+4, paginate.nbPages)) %}
                        <li {% if p == paginate.page %} class="active page-item" {else} class="page-item" {% endif %}>
                            <a  
                                class="page-link" 
                                href="{{ path(paginate.nameRoute, paginate.paramsRoute|merge({'page': p})) }}#store"
                            >
                                {{ p }}
                            </a>
                        </li>
                    {% endfor %}
                    {% if paginate.page < paginate.nbPages %}
                        <li class="page-item">
                            <a 
                                class="page-link" 
                                href="{{ path(paginate.nameRoute,paginate.paramsRoute|merge({'page': paginate.page+1})) }}#store"
                            >&#62;</a>
                        </li>
                        <li class="page-item">
                            <a  
                                class="page-link" 
                                href="{{ path(paginate.nameRoute,paginate.paramsRoute|merge({'page': paginate.nbPages})) }}#store"
                            >&raquo;</a>
                        </li>
                    {% endif %}
                    </ul>
                </div>
            {% endif %}
        </div>
    </div>

    <div>Icons made by
        <a href="https://www.flaticon.com/authors/alfredo-hernandez" title="Alfredo Hernandez">Alfredo Hernandez</a>
        from <a href="https://www.flaticon.com/"     title="Flaticon">www.flaticon.com</a>
    </div>
    <div>Icons made by 
        <a href="https://www.flaticon.com/authors/freepik" title="Freepik">Freepik</a>
        from <a href="https://www.flaticon.com/"     title="Flaticon">www.flaticon.com</a>
    </div>
    <div>Icons made by 
        <a href="https://www.flaticon.com/authors/turkkub" title="turkkub">turkkub</a>
        from <a href="https://www.flaticon.com/"     title="Flaticon">www.flaticon.com</a>
    </div>
    <div>Icons made by 
        <a href="https://www.flaticon.com/authors/eucalyp" title="Eucalyp">Eucalyp</a>
        from <a href="https://www.flaticon.com/"     title="Flaticon">www.flaticon.com</a>
    </div>
    <div>Icons made by 
        <a href="https://www.flaticon.com/authors/monkik" title="monkik">monkik</a> 
        from <a href="https://www.flaticon.com/"     title="Flaticon">www.flaticon.com</a>
    </div>
    <div>Icons made by 
        <a href="https://www.flaticon.com/authors/pixelmeetup" title="Pixelmeetup">Pixelmeetup</a>
        from <a href="https://www.flaticon.com/"     title="Flaticon">www.flaticon.com</a>
    </div>
    <div>Icons made by 
        <a href="https://www.flaticon.com/authors/iconixar" title="iconixar">iconixar</a>
        from <a href="https://www.flaticon.com/"     title="Flaticon">www.flaticon.com</a>
    </div>
    <div>Icons made by
        <a href="https://www.flaticon.com/authors/pixel-perfect" title="Pixel perfect">Pixel perfect</a>
        from <a href="https://www.flaticon.com/"     title="Flaticon">www.flaticon.com</a>
    </div>
    <div>Icons made by 
        <a href="https://www.flaticon.com/authors/good-ware" title="Good Ware">Good Ware</a>
        from <a href="https://www.flaticon.com/"     title="Flaticon">www.flaticon.com</a>
    </div>
    <div>Icons made by 
        <a href="https://www.flaticon.com/authors/eucalyp" title="Eucalyp">Eucalyp</a>
        from <a href="https://www.flaticon.com/"     title="Flaticon">www.flaticon.com</a>
    </div>
{% endblock %}
